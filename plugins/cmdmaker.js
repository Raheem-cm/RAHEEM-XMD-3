const { cmd } = require('../command');

cmd({
    pattern: "makecmd",
    alias: ["gen", "create"],
    desc: "Generates commands with different dynamic fancy styles.",
    category: "owner",
    react: "ğŸ¨",
    filename: __filename
}, async (conn, mek, m, { from, q, reply }) => {
    try {
        if (!q || !q.includes(':')) {
            return reply("*MK-XR DYNAMIC GEN* ğŸ¨\n\n*Usage:* `.makecmd name:instruction` ");
        }

        let [name, ...descParts] = q.split(':');
        let cmdName = name.trim().toLowerCase().replace(/[^a-z0-9]/g, '');
        let cmdInstruction = descParts.join(':').trim().replace(/'/g, "\\'").replace(/`/g, "");

        // Hapa ndipo tunapozalisha kodi yenye urembo wa kubadilika-badilika (Dynamic)
        const generatedCode = `const { cmd } = require('../command');

cmd({
    pattern: "${cmdName}",
    desc: '${cmdInstruction}',
    category: "generated",
    react: "âœ¨",
    filename: __filename
}, async (conn, mek, m, { from, pushName }) => {
    try {
        const date = new Date().toLocaleDateString();
        const time = new Date().toLocaleTimeString();
        const styles = [
            // STYLE 1: BOX STYLE
            \`â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\\n      âš¡ *MORTAL-KOMBAT-XR* âš¡\\nâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\\nğŸ‘¤ *User:* \${pushName}\\nğŸ“… *Date:* \${date}\\nâŒš *Time:* \${time}\\nğŸ‘‘ *Owner:* Nyoni XMD\\n\\n*ğŸ“ Task:* ${cmdInstruction}\\n\\n> *Powered by Nyoni XMD Engine*\`,
            
            // STYLE 2: CLEAN LINE STYLE
            \`âœ¨ *MK-XR DYNAMIC MENU* âœ¨\\n\\n*â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”*\\nğŸ‘¤ *Hello:* \${pushName}\\nğŸ•’ *Time:* \${time}\\nğŸ“‚ *Command:* ${cmdName}\\nğŸ“ *Info:* ${cmdInstruction}\\n*â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”*\\n\\n> *Generated by MK-XR System*\`,
            
            // STYLE 3: SPARKLE STYLE
            \`ğŸŒŸ â”â”â” â€¢ âš¡ â€¢ â”â”â” ğŸŒŸ\\n  *NYONI XMD ENGINE*\\nğŸŒŸ â”â”â” â€¢ âš¡ â€¢ â”â”â” ğŸŒŸ\\n\\nğŸ‘¤ *User:* \${pushName}\\nğŸ“… *Date:* \${date}\\nğŸš€ *Action:* ${cmdInstruction}\\n\\nğŸ’ *Enjoy the service!*\\n\\n> *Mortal Kombat System* \`
        ];

        // Hapa bot inachagua urembo mmoja kati ya hiyo mitatu kila inapopigwa command
        const randomStyle = styles[Math.floor(Math.random() * styles.length)];

        await conn.sendMessage(from, { 
            text: randomStyle,
            contextInfo: {
                externalAdReply: {
                    title: "ğ™¼ğ™¾ğšğšƒğ™°ğ™»-ğ™ºğ™¾ğ™¼ğ™±ğ™°ğšƒ-ğš‡ğš ğ™³ğšˆğ™½ğ™°ğ™¼ğ™¸ğ™²",
                    body: "Dynamic Fancy Menu",
                    thumbnailUrl: "https://telegra.ph/file/dcce2a3952975107ee010.jpg",
                    sourceUrl: "https://whatsapp.com/channel/0029VbAffhD2ZjChG9DX922r",
                    mediaType: 1,
                    renderLargerThumbnail: true
                }
            }
        }, { quoted: mek });
    } catch (e) {
        console.error(e);
    }
});`;

        await conn.sendMessage(from, { 
            text: `*âœ… DYNAMIC COMMAND GENERATED!*\n\n*Kila ukiitumia itabadilisha urembo (Style).* \n\n\`\`\`javascript\n${generatedCode}\n\`\`\`` 
        }, { quoted: mek });

    } catch (e) {
        reply("âŒ Error generating dynamic code.");
    }
});
